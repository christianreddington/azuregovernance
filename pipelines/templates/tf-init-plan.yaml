parameters:
  tfCliInit: ""

steps:

  - bash: |
      printenv | grep ARM
      printenv | grep TF_
    displayName: "Debug environment"
    name: debugenvironment
    workingDirectory: src/terraform
    enabled: "true"
    env:
      ARM_CLIENT_SECRET: $(tfClientSecret)
      TF_CLI_ARGS_init: ${{ parameters.tfCliInit }}"

  - bash: |
      terraform init
    displayName: "Terraform Init"
    name: init
    workingDirectory: src/terraform
    enabled: "true"
    env:
      ARM_CLIENT_SECRET: $(tfClientSecret)


  - bash: |
      terraform plan
    displayName: "Terraform Plan"
    name: plan
    workingDirectory: src/terraform
    enabled: "true"
    env:
      ARM_CLIENT_SECRET: $(tfClientSecret)
      TF_CLI_ARGS_init: ${{ parameters.tfCliInit }}"
